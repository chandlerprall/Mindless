<!DOCTYPE html><html><head><title>Lab 13</title><style>*{cursor:default;}body{overflow:hidden;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select: none;-ms-user-select:none;background:#fff;width:100%;height:100%;margin:auto}#c{position:absolute}#d{position:absolute;z-index:1;left:20px;bottom:20px;width:90%;height:130px;padding:16px 550px 16px 16px;background-image:-moz-linear-gradient(center right,rgba(0,0,0,0),rgba(0,0,0,1.0));background-image:-webkit-gradient(linear,right top,left top,from(rgba(0,0,0,0)),to(rgba(0,0,0,1.0)));font-family:Courier, sans-serif;color:#FFF;display:none}#d:after{content:"(Press any key to close)";font-size:11px;position:absolute;left:10px;bottom:-18px;color:#FFF;}#d.scientist{background-image:-moz-linear-gradient(center right,rgba(226,223,222,0),rgba(226,223,222,1.0));background-image:-webkit-gradient(linear,right top,left top,from(rgba(226,223,222,0)),to(rgba(226,223,222,1.0)));color:#333}#d.civilian{background-image:-moz-linear-gradient(center right,rgba(80,89,43,0),rgba(80,89,43,1.0));background-image: -webkit-gradient(linear,right top,left top, from(rgba(80,89,43,0)),to(rgba(80,89,43,1.0)));color:#FFF}#t{max-width:500px}
</style></head><body><canvas id="c"></canvas><div id="d"><div id="t"></div></div><script>
var d=void 0,g=!0,h=null,l=!1,n=Math.sqrt;function p(a,b,c){this.x=a||0;this.y=b||0;this.a=c||0}p.prototype.set=function(a,b,c){this.x=a;this.y=b;this.a=c;return this};p.prototype.n=function(){return new p(this.x,this.y,this.a)};p.prototype.sub=function(a){this.x-=a.x;this.y-=a.y;this.a-=a.a;return this};p.prototype.add=function(a){this.x+=a.x;this.y+=a.y;this.a+=a.a;return this};p.prototype.C=function(a){var b=this.x,c=this.y,e=this.a;this.x=c*a.a-e*a.y;this.y=e*a.x-b*a.a;this.a=b*a.y-c*a.x;return this};
p.prototype.B=function(a){return this.x*a.x+this.y*a.y+this.a*a.a};p.prototype.normalize=function(){var a=n(this.x*this.x+this.y*this.y+this.a*this.a);this.x/=a;this.y/=a;this.a/=a;return this};p.prototype.length=function(){return n(this.w())};p.prototype.w=function(){return this.x*this.x+this.y*this.y+this.a*this.a};p.prototype.copy=function(a){this.x=a.x;this.y=a.y;this.a=a.a;return this};
p.prototype.J=function(){var a=s[u].j.k,b=a[0],c=a[4],e=a[8],f=a[1],k=a[5],j=a[9],a=a[10];this.y=Math.asin(Math.min(Math.max(e,-1),1));0.99999>Math.abs(e)?(this.x=Math.atan2(-j,a),this.a=Math.atan2(-c,b)):(this.x=Math.atan2(f,k),this.a=0)};p.prototype.r=function(a){this.x*=a;this.y*=a;this.a*=a;return this};M4=function(a){this.k=a||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};
M4.prototype.copy=function(a){var b=this.k,a=a.k;b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15]};
M4.prototype.F=function(a){var b=this.k,c=y,e=new p(0,1,0),c=this.I().n().sub(a).normalize();0===c.length()&&(c.a=1);z.copy(e).C(c).normalize();0===z.length()&&(c.x+=1E-4,z.copy(e).C(c).normalize());A.copy(c).C(z);b[0]=z.x;b[4]=A.x;b[8]=c.x;b[1]=z.y;b[5]=A.y;b[9]=c.y;b[2]=z.a;b[6]=A.a;b[10]=c.a};
M4.prototype.O=function(a){var b=this.k,c=a.k,e=c[0],f=c[4],k=c[8],j=c[12],q=c[1],i=c[5],o=c[9],r=c[13],m=c[2],t=c[6],v=c[10],w=c[14],x=c[3],C=c[7],D=c[11],c=c[15];b[0]=o*w*C-r*v*C+r*t*D-i*w*D-o*t*c+i*v*c;b[4]=j*v*C-k*w*C-j*t*D+f*w*D+k*t*c-f*v*c;b[8]=k*r*C-j*o*C+j*i*D-f*r*D-k*i*c+f*o*c;b[12]=j*o*t-k*r*t-j*i*v+f*r*v+k*i*w-f*o*w;b[1]=r*v*x-o*w*x-r*m*D+q*w*D+o*m*c-q*v*c;b[5]=k*w*x-j*v*x+j*m*D-e*w*D-k*m*c+e*v*c;b[9]=j*o*x-k*r*x-j*q*D+e*r*D+k*q*c-e*o*c;b[13]=k*r*m-j*o*m+j*q*v-e*r*v-k*q*w+e*o*w;b[2]=i*
w*x-r*t*x+r*m*C-q*w*C-i*m*c+q*t*c;b[6]=j*t*x-f*w*x-j*m*C+e*w*C+f*m*c-e*t*c;b[10]=f*r*x-j*i*x+j*q*C-e*r*C-f*q*c+e*i*c;b[14]=j*i*m-f*r*m-j*q*t+e*r*t+f*q*w-e*i*w;b[3]=o*t*x-i*v*x-o*m*C+q*v*C+i*m*D-q*t*D;b[7]=f*v*x-k*t*x+k*m*C-e*v*C-f*m*D+e*t*D;b[11]=k*i*x-f*o*x-k*q*C+e*o*C+f*q*D-e*i*D;b[15]=f*o*m-k*i*m+k*q*t-e*o*t-f*q*v+e*i*v;this.r(1/a.X());return this};
M4.prototype.r=function(a){var b=this.k;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this};
M4.prototype.X=function(){var a=this.k,b=a[0],c=a[4],e=a[8],f=a[12],k=a[1],j=a[5],q=a[9],i=a[13],o=a[2],r=a[6],m=a[10],t=a[14],v=a[3],w=a[7],x=a[11],a=a[15];return f*q*r*v-e*i*r*v-f*j*m*v+c*i*m*v+e*j*t*v-c*q*t*v-f*q*o*w+e*i*o*w+f*k*m*w-b*i*m*w-e*k*t*w+b*q*t*w+f*j*o*x-c*i*o*x-f*k*r*x+b*i*r*x+c*k*t*x-b*j*t*x-e*j*o*a+c*q*o*a+e*k*r*a-b*q*r*a-c*k*m*a+b*j*m*a};
M4.prototype.multiply=function(a,b){var c=a.k,e=b.k,f=this.k,k=c[0],j=c[4],q=c[8],i=c[12],o=c[1],r=c[5],m=c[9],t=c[13],v=c[2],w=c[6],x=c[10],C=c[14],D=c[3],ha=c[7],ia=c[11],c=c[15],ja=e[0],ka=e[4],la=e[8],ma=e[12],na=e[1],oa=e[5],pa=e[9],qa=e[13],ra=e[2],sa=e[6],ta=e[10],ua=e[14],va=e[3],wa=e[7],xa=e[11],e=e[15];f[0]=k*ja+j*na+q*ra+i*va;f[4]=k*ka+j*oa+q*sa+i*wa;f[8]=k*la+j*pa+q*ta+i*xa;f[12]=k*ma+j*qa+q*ua+i*e;f[1]=o*ja+r*na+m*ra+t*va;f[5]=o*ka+r*oa+m*sa+t*wa;f[9]=o*la+r*pa+m*ta+t*xa;f[13]=o*ma+r*
qa+m*ua+t*e;f[2]=v*ja+w*na+x*ra+C*va;f[6]=v*ka+w*oa+x*sa+C*wa;f[10]=v*la+w*pa+x*ta+C*xa;f[14]=v*ma+w*qa+x*ua+C*e;f[3]=D*ja+ha*na+ia*ra+c*va;f[7]=D*ka+ha*oa+ia*sa+c*wa;f[11]=D*la+ha*pa+ia*ta+c*xa;f[15]=D*ma+ha*qa+ia*ua+c*e;return this};M4.prototype.Z=function(){var a=this.k;return n(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],Math.max(a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10])))};
M4.prototype.A=function(a){var b=this.k,c=a.x,e=a.y,f=a.a,k=1/(b[3]*c+b[7]*e+b[11]*f+b[15]);a.x=(b[0]*c+b[4]*e+b[8]*f+b[12])*k;a.y=(b[1]*c+b[5]*e+b[9]*f+b[13])*k;a.a=(b[2]*c+b[6]*e+b[10]*f+b[14])*k};M4.prototype.L=function(a){var b=this.k,c=a.x,e=a.y,f=a.a,k=a.f;a.x=b[0]*c+b[4]*e+b[8]*f+b[12]*k;a.y=b[1]*c+b[5]*e+b[9]*f+b[13]*k;a.a=b[2]*c+b[6]*e+b[10]*f+b[14]*k;a.f=b[3]*c+b[7]*e+b[11]*f+b[15]*k};M4.prototype.M=function(a){var b=this.k;b[12]=a.x;b[13]=a.y;b[14]=a.a};var aa=new p;
M4.prototype.I=function(){var a=this.k;return aa.set(a[12],a[13],a[14])};M4.prototype.R=function(a){var b=this.k,c=a.x,e=a.y,f=a.a,a=Math.cos(c),c=Math.sin(c),k=Math.cos(e),e=Math.sin(e),j=Math.cos(f),f=Math.sin(f),q=a*j,i=a*f,o=c*j,r=c*f;b[0]=k*j;b[4]=-k*f;b[8]=e;b[1]=i+o*e;b[5]=q-r*e;b[9]=-c*k;b[2]=r-q*e;b[6]=o+i*e;b[10]=a*k};
M4.prototype.H=function(a){var b=this.k,a=a.k,c=new p,e=1/c.set(a[0],a[1],a[2]).length(),f=1/c.set(a[4],a[5],a[6]).length(),c=1/c.set(a[8],a[9],a[10]).length();b[0]=a[0]*e;b[1]=a[1]*e;b[2]=a[2]*e;b[4]=a[4]*f;b[5]=a[5]*f;b[6]=a[6]*f;b[8]=a[8]*c;b[9]=a[9]*c;b[10]=a[10]*c;return this};M4.prototype.ba=function(a,b,c,e){var f=this.k;f[0]=2/(b-a);f[4]=0;f[8]=(b+a)/(b-a);f[12]=0;f[1]=0;f[5]=2/(e-c);f[9]=(e+c)/(e-c);f[13]=0;f[2]=0;f[6]=0;f[10]=-251/249;f[14]=-500/249;f[3]=0;f[7]=0;f[11]=-1;f[15]=0;return this};
M4.prototype.ca=function(){var a=B/E,b=1*Math.tan(35*Math.PI/360),c=-b;return this.ba(c*a,b*a,c,b)};V4=function(a,b,c,e){this.x=a;this.y=b;this.a=c;this.f=e};V4.prototype.set=function(a,b,c,e){this.x=a;this.y=b;this.a=c;this.f=e;return this};V4.prototype.Y=function(){var a=n(G.x*G.x+G.y*G.y+G.a*G.a);a?(this.x/=a,this.y/=a,this.a/=a,this.f/=a):(this.a=this.y=this.x=0,this.f=1)};V4.prototype.copy=function(a){this.x=a.x;this.y=a.y;this.a=a.a;this.f=a.f!==d?a.f:1;return this};
V4.prototype.n=function(){return new V4(this.x,this.y,this.a,this.f)};FR=function(){this.Q=[new V4,new V4,new V4,new V4,new V4,new V4]};
FR.prototype.fa=function(){var a=projectionScreenMatrix;H=this.Q;var b=a.k,a=b[0],c=b[1],e=b[2],f=b[3],k=b[4],j=b[5],q=b[6],i=b[7],o=b[8],r=b[9],m=b[10],t=b[11],v=b[12],w=b[13],x=b[14],b=b[15];H[0].set(f-a,i-k,t-o,b-v);H[1].set(f+a,i+k,t+o,b+v);H[2].set(f+c,i+j,t+r,b+w);H[3].set(f-c,i-j,t-r,b-w);H[4].set(f-e,i-q,t-m,b-x);H[5].set(f+e,i+q,t+m,b+x);for(u=0;6>u;u++)G=H[u],G.Y()};
FR.prototype.contains=function(a){G=this.Q;I=a.j.k;for(var b=0;6>b;b++)if(H=G[b].x*I[12]+G[b].y*I[13]+G[b].a*I[14]+G[b].f,H<=-a.m.S*a.j.Z())return l;return g};F=function(a,b,c){this.b=a;this.j=b;this.G=c};F.prototype.n=function(){return new F([this.b[0].n(),this.b[1].n(),this.b[2].n()],this.j.n(),this.G.n())};F.prototype.W=function(){this.f=(this.b[0].f+this.b[1].f+this.b[2].f)/3;return this};
Geometry=function(a,b){this.b=[];for(u=0;u<a.length;u+=3)this.b.push(new p(a[u],a[u+1],a[u+2]));this.l=[];for(u=0;u<b.length;u+=4)this.l.push(new F([b[u],b[u+1],b[u+2]],b[u+3]));var c;for(c=0;c<this.l.length;c++)this.l[c].G=this.b[this.l[c].b[1]].n().sub(this.b[this.l[c].b[0]]).C(this.b[this.l[c].b[2]].n().sub(this.b[this.l[c].b[0]])).normalize();this.V()};Geometry.prototype.V=function(){var a=0;for(u=0;u<this.b.length;u++){var b=this.b[u].w();b>a&&(a=b)}this.S=n(a)};
Model=function(a,b){this.U=this.T(b);this.m=a;this.j=new M4;this.d=new p;this.t=new p;this.e=new p;this.o=[];this.p=[];this.h=[];this.u=l};Model.prototype.T=function(a){var b=[];for(u=0;u<a.length;u+=4)b.push(new V4(a[u],a[u+1],a[u+2],a[u+3]));return b};
var J=document.getElementById("c"),K=J.getContext("2d"),ba=document.getElementById("d"),ca=document.getElementById("t"),L=window,B=L.innerWidth,E=L.innerHeight,da=L.requestAnimationFrame||L.mozRequestAnimationFrame||L.webkitRequestAnimationFrame||L.oRequestAnimationFrame||L.msRequestAnimationFrame||function(a){setTimeout(a,60)},M;
function ea(){this.K=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]];this.d=[];for(var a=0;256>a;a++)this.d[a]=Math.floor(256*Math.random());this.z=[];for(a=0;512>a;a++)this.z[a]=this.d[a&255]}ea.prototype.B=function(a,b,c){return a[0]*b+a[1]*c};
ea.prototype.ea=function(a,b){var c,e,f;f=0.5*(n(3)-1);f*=a+b;var k=Math.floor(a+f),j=Math.floor(b+f),q=(3-n(3))/6;f=(k+j)*q;c=a-(k-f);var i=b-(j-f),o,r;c>i?(o=1,r=0):(o=0,r=1);e=c-o+q;var m=i-r+q;f=c-1+2*q;var q=i-1+2*q,t=k&255,j=j&255,k=this.z[t+this.z[j]]%12;o=this.z[t+o+this.z[j+r]]%12;r=this.z[t+1+this.z[j+1]]%12;j=0.5-c*c-i*i;0>j?c=0:(j*=j,c=j*j*this.B(this.K[k],c,i));i=0.5-e*e-m*m;0>i?e=0:(i*=i,e=i*i*this.B(this.K[o],e,m));m=0.5-f*f-q*q;0>m?f=0:(m*=m,f=m*m*this.B(this.K[r],f,q));return 70*
(c+e+f)};var fa=new ea;M=fa.ea.bind(fa);
var ga=(new M4).ca(),ya=new M4([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),za=new M4([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),Aa=new p(0,10,0),Ba=new p(0,20,-35),Ca=new p(0,0,-15),Da=new p(0,10,0),N=[],Ea=[],Fa=[],O=[],P={floor_0:[35,30,25,1],floor_1:[40,35,30,1],floor_2:[35,30,35,1],wall_0:[80,70,70,1],wall_1:[85,75,70,1],wall_2:[80,75,75,1],terminal:[100,90,90,1,20,80,10,1],player:[76,100,107,1,204,204,204,1,241,219,203,1,149,149,149,1,149,149,149,1,74,15,0,1,149,149,149,1,35,49,56,1],guard:[52,61,89,1,33,34,
38,1,224,173,166,1,149,149,149,1,149,149,149,1,52,61,89,1,149,149,149,1,89,88,87,1],scientist:[230,230,230,1,77,77,77,1,245,224,205,1,149,149,149,1,149,149,149,1,179,179,179,1,149,149,149,1,77,77,77,1],civilian:[80,89,43,1,51,39,22,1,241,219,203,1,149,149,149,1,149,149,149,1,229,237,150,1,149,149,149,1,73,56,32,1],infected:[87,32,0,1,241,244,206,1,241,244,206,1,149,149,149,1,149,149,149,1,207,158,118,1,149,149,149,1,44,28,21,1],poker:[69,51,32,1]},Ga=[[0,0.5,0,0,0.5,0,0,0.1,0,0,-0.3,0,0,-0.3,0,-0.1,
-0.2,0.1,0,0.1,0,0,0.1,0,0,0.1,0,0,0.1,0,0,0,0,0,0,0,0,0.1,0,0,0.1,1.2,0.1,0.3,0.1,0,0.5,0.1,0.1,0.3,0,0,-0.3,-0.1,0,-0.3,-0.1,0,0.5,0.1,0,0.7,5,0,0.7,5,0,-0.4,5.1,0,-0.4,5.1,0,0.2,-1,0,0.2,-1,0,0.3,-1,0,0.3,-1,-0.2,-0.1,2.6,-0.2,-0.3,2.6,-0.2,-0.3,2.5,-0.2,-0.1,2.6,0,0.1,-0.2,0,0.1,-0.2,0,0,-0.2,0,0,-0.2,0.1,0.2,1.2,0.1,0.3,1.1,-0.1,0,1.2,0,0,1.1,0,0.1,0,0,0.1,0,0,0.1,0,0,0.1,0,0,0.1,0,0,0.1,0,0,0.1,0,0,0.1,0,0,0.1,0,0,0.1,0,0,0.1,0,0,0.1,0,0,0.1,0,0,0.1,0,0,0.1,0,0,0.1,0,0,0.1,0,0,0.1,0,0,0.1,0,
0,0.1,0,0,0.1,0,0,0.1,0,0,0.1,0,0,0.1,0,0,0.1,0,0,0.1,0,0,0.1,0,0,0.1,0,0,-0.4,-5.3,0,0.2,-5.3,0,0.2,-5.3,0,-0.4,-5.3,0,-0.7,2.4,0,-0.7,2.4,0,-0.3,2.5,0,-0.3,2.5,0,0.3,-2.7,0,0.3,-2.7,0,0.7,-2.6,0,0.7,-2.6,0,0.3,4.7,0,0.3,4.7,0,0.6,4.6,0,0.6,4.6,0,-0.4,-5.1,0,-0.4,-5.1,0,-0.2,-5.1,0,-0.2,-5.1],[0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0.5,0.3,0.1,0,0.1,0.1,0,0.1,0.1,-0.5,-0.3,0.1,-0.5,-0.3,0.1,0,0.1,0,0,1.2,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,
0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,2.9,-4.3,0,2.9,-4.3,0,3.2,-4,0,3.1,-4,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,1.4,-2,0.1,1.4,-2,0.1,0.9,-2.3,0.1,0.9,-2.3,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,
0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1,0.1,0,0.1]],Ha=[[0,0,0.9,0,-1.5,1,0,-1.5,1,0,0,0.9,0,0,0.8,0,0,0.8,0,-1.5,0.9,0,-1.5,0.9,0,-2,1,0,-2,1,0,-2,0.9,0,-2,0.9],[0.07,2.8,-3,0.07,2.2,-3,0.06,2.2,-3,0.06,2.8,-3,0.07,2.8,-3,0.06,2.8,-3,0.06,2.2,-3.1,0.07,2.17,-3.1,0.06,2,-3,0.06,2,-3,0.06,2,-3,0.06,2,-3]],Q={person:new Geometry([-0.4,7,-0.6,-1,7,-0.6,-1.2,11.3,-0.6,
0.4,7.4,-0.6,1,7.4,-0.6,-1.3,11.6,-0.6,0.3,11.9,-0.6,1.5,11.5,-0.6,1.2,11.3,-0.6,-0.2,11.9,-0.6,0.9,11.5,0.5,1.5,11.6,0.5,0.2,11.9,0.5,-0.2,11.9,-0.6,-1.5,11.4,0.4,1,6.8,0.3,-1,11.4,0.5,-1,7.2,0.5,-0.4,7.2,0.5,0.4,6.8,0.3,0.9,0,-1.7,0.5,0,-1.7,0.5,0.3,-3.2,0.9,0.3,-3.2,1.7,7.3,0.3,1.4,7.3,0.3,1.4,7.3,0,1.7,7.3,0,-1.3,7.6,-1.6,-1.2,7.7,-1.8,-1,7.7,-1.7,-1,7.5,-1.5,1.6,9.3,-0.1,1.2,9.2,-0.1,1.6,9.3,0.4,1.2,9.3,0.4,-1.5,9.2,-0.3,-1.1,9.2,-0.2,-1.4,9.3,-0.8,-1,9.3,-0.7,0.3,13.6,0.4,0.3,13.6,-0.4,-0.3,
13.6,-0.5,-0.3,13.6,0.4,0.2,12.1,0.2,-0.2,12.1,0.2,0.3,12.1,-0.3,-0.2,12.1,-0.3,0.3,12.1,0.3,-0.3,12.1,0.3,0.4,12.1,-0.4,-0.3,12.1,-0.4,0.5,12.8,0.7,-0.5,12.8,0.7,0.5,12.8,-0.7,-0.5,12.8,-0.8,-0.3,12.8,-0.8,-0.1,12.8,-0.8,0.2,12.8,-0.7,0.4,12.8,-0.7,0.5,13.1,0.7,-0.5,13.1,0.7,0.5,13.1,-0.7,0.4,13.1,-0.7,-0.5,13.1,-0.8,-0.3,13.1,-0.8,-0.1,13.1,-0.8,0.2,13.1,-0.7,-0.9,0.4,3.4,-0.9,0,1.9,-0.4,0,1.9,-0.4,0.4,3.4,0.9,4.4,-2.3,0.5,4.4,-2.3,0.9,4.1,-1.8,0.5,4.1,-1.8,-0.9,3.8,1,-0.4,3.8,1,-0.9,3.7,0.4,-0.4,
3.7,0.4,0.9,0.6,-2.1,0.5,0.6,-2.1,0.9,0.5,-1.7,0.5,0.5,-1.7,-0.9,1,3.2,-0.4,1,3.2,-0.9,0.8,2.7,-0.4,0.8,2.7],[0,1,2,0,3,0,2,0,4,3,2,0,4,2,5,0,6,7,8,0,9,6,8,0,5,9,8,0,4,5,8,0,10,11,12,0,10,12,13,0,10,13,14,0,15,10,14,0,15,14,16,0,16,17,18,0,16,18,19,0,15,16,19,0,20,21,22,1,22,23,20,1,17,16,2,0,2,1,17,0,14,13,9,0,9,5,14,0,24,25,26,2,26,27,24,2,15,4,8,0,8,10,15,0,28,29,30,2,30,31,28,2,8,7,32,0,32,33,8,0,7,11,34,0,34,32,7,0,11,10,35,0,35,34,11,0,10,8,33,3,33,35,10,3,16,14,36,0,36,37,16,0,14,5,38,0,38,
36,14,0,5,2,39,0,39,38,5,0,2,16,37,4,37,39,2,4,33,32,27,2,27,26,33,2,32,34,24,2,24,27,32,2,34,35,25,2,25,24,34,2,35,33,26,2,26,25,35,2,37,36,28,2,28,31,37,2,36,38,29,2,29,28,36,2,38,39,30,2,30,29,38,2,39,37,31,2,31,30,39,2,11,7,6,0,6,12,11,0,40,41,42,5,42,43,40,5,13,12,44,2,44,45,13,2,12,6,46,2,46,44,12,2,6,9,47,2,47,46,6,2,9,13,45,2,45,47,9,2,45,44,48,2,48,49,45,2,44,46,50,2,50,48,44,2,46,47,51,2,51,50,46,2,47,45,49,2,49,51,47,2,49,48,52,2,52,53,49,2,48,50,54,2,54,52,48,2,50,51,55,2,50,55,56,2,50,
56,57,2,50,57,58,2,50,58,59,2,50,59,54,2,51,49,53,2,53,55,51,2,53,52,60,5,60,61,53,5,52,54,62,5,62,60,52,5,59,63,62,2,62,54,59,2,55,53,61,5,61,64,55,5,61,60,40,5,40,43,61,5,60,62,41,5,41,40,60,5,65,64,42,2,66,65,42,2,67,66,42,2,63,67,42,2,62,63,42,2,62,42,41,2,64,61,43,5,43,42,64,5,55,64,65,2,65,56,55,2,56,65,66,5,66,57,56,5,57,66,67,2,67,58,57,2,58,67,63,5,63,59,58,5,18,0,3,6,3,19,18,6,68,69,70,1,70,71,68,1,3,4,72,7,72,73,3,7,4,15,74,7,74,72,4,7,15,19,75,7,75,74,15,7,19,3,73,7,73,75,19,7,18,17,76,
7,76,77,18,7,17,1,78,7,78,76,17,7,1,0,79,7,79,78,1,7,0,18,77,7,77,79,0,7,73,72,80,7,80,81,73,7,72,74,82,7,82,80,72,7,74,75,83,7,83,82,74,7,75,73,81,7,81,83,75,7,77,76,84,7,84,85,77,7,76,78,86,7,86,84,76,7,78,79,87,7,87,86,78,7,79,77,85,7,85,87,79,7,81,80,23,1,23,22,81,1,80,82,20,1,20,23,80,1,82,83,21,1,21,20,82,1,83,81,22,1,22,21,83,1,85,84,68,1,68,71,85,1,84,86,69,1,69,68,84,1,86,87,70,1,70,69,86,1,87,85,71,1,71,70,87,1]),poker:new Geometry([1.5,7.4,-0.3,1.5,8,-3.7,1.6,8,-3.7,1.6,7.4,-0.3,1.5,7.7,
-0.3,1.6,7.7,-0.3,1.6,8.3,-3.7,1.5,8.3,-3.7,1.6,8.4,-4.9,1.5,8.4,-4.9,1.5,8.4,-4.9,1.6,8.4,-4.9],[0,1,2,0,2,3,0,0,4,5,6,0,6,7,4,0,0,3,5,0,5,4,0,0,3,2,6,0,6,5,3,0,8,9,10,0,10,11,8,0,1,0,4,0,4,7,1,0,2,1,9,0,9,8,2,0,1,7,10,0,10,9,1,0,7,6,11,0,11,10,7,0,6,2,8,0,8,11,6,0]),tile:new Geometry([-4.7,0,-4.7,4.7,0,-4.7,4.7,0,4.7,-4.7,0,4.7],[2,1,0,0,3,2,0,0]),wall:new Geometry([-5,10,-5,5,10,-5,5,0,-5,-5,0,-5],[2,1,0,0,3,2,0,0]),terminal:new Geometry([-1,8,2,1,8,2,2,0,2,-2,0,2,-2,0,-2,-1,10,0,2,0,-2,1,10,0],
[2,1,0,0,3,2,0,0,3,0,5,0,5,4,3,0,4,5,7,0,7,6,4,0,6,7,1,0,1,2,6,0,1,7,5,1,5,0,1,1])},s=[],R,Ia=0;function S(a){Da.copy(a.d).sub(R.d);Da.y=10;Ca.set(10,25,10)}
var Ja,T=[{e:1,q:-5,f:"scientist",1:"<b>SOLOMON ASCH:</b><br>Get back! I'm warning you!",2:"Listen, I can't defend myself. Think about what you're doing!"},{e:1,q:3,f:"scientist",1:"<b>ALBERT BANDURA:</b><br>Wait! We think you may be sick, we're only trying to help.",2:"Can you hear us? You're hearing another voice, aren't you?"},{e:2,q:3,f:"scientist",1:"<b>STANLEY SCHACHTER:</b><br>Don't get too close! He's infected!",2:"Yes, YOU. YOU are infected."},{e:2,q:2,f:"scientist",1:"<b>GUSTAVE LE BON:</b><br>Come on, would you put that thing down?",
2:"You probably think I'm trying to trick you. Why are all the INFECTEDS thinking that?!"},{e:3,q:1,f:"scientist",1:"<b>STAN MILGRAM:</b><br>PLEASE! Don't kill the refugees. Don't activate the self destruct. Don't do whatever it's telling you, please . . .",2:"We're running out of guards . . . you win . . ."},{e:2,q:1,f:"scientist",1:"<b>ROBERT SHILLER:</b><br>It was supposed to just be a high tech personal assistant, like that phone app that talks to you. But it seems that once it's in your head, you can't tell the difference between it, and you.",
2:"The hard reset probably didn't help things either. Let me guess, the last thing you remember is just standing around, this voice telling you what to do?"},{e:1,q:1,f:"scientist",1:"<b>ROD DICKINSON:</b><br>You look disoriented. Did you get hit by the hard reset?",2:"Can you just tell me what it's saying to you? It might help us solve all this faster."},{e:3,q:2,f:"scientist",1:"<b>KURT LEWIN:</b><br>If things keep up like this, they'll blow the place, no questions asked.",2:"That won't stop the spread! Plus they'd be blowing up the debugger along with us!"},
{e:1,q:1,f:"civilian",1:"<b>PETER HOOK:</b><br>They've got an debugger off in the room to the far left. Can't get it out though, the scientists are being held in by the INFECTEDS.",2:"I guess there's too many of 'em for the guards . . . just terrible."},{e:2,q:3,f:"scientist",1:"<b>IVAN PAVLOV:</b><br>If I would have thought my computer science degree would have come to being stabbed by buggy software, I would have gone to art school.",2:"You wouldn't guess it, but I'm quite good with charcoal. A lot better than QAing software."},
{e:1,q:3,f:"civilian",1:"<b>PAUL COOK:</b><br>This laboratory isn't even that old, and now it looks like we'll have to destroy it.",2:"I'm not kidding, there's a control room to the far right that could blow this whole place up."},{e:4,q:5,f:"scientist",1:"<b>GUSTAV FECHNER:</b><br>I stopped going to church . . . probably four years ago. Sometimes I think that if I had been there this Sunday, I might have avoided this.",2:"But it wouldn't have saved all of these people, would it? See, that's the problem with the whole thing. I guess I'd just rather be here fixing things myself."},
{e:4,q:3,f:"civilian",1:"<b>GLEN MATLOCK:</b><br>Sometimes I wonder what it's like to be a zombie. Would you know what you're doing is weird?",2:"I suppose not. It would make more sense to me that you simply saw things differently. Does that make sense?"}];function Ka(a,b){return a.q+Math.random()-b.q*Math.random()}var La=0,U;
Ja={timeout:h,speak:function(a,b){if(0!==T.length){var c=[],e;for(U=0;U<T.length;U++)if(!(T[U].e>a||T[U].f!==b.type)&&!(T[U].p!==d&&T.p!==R.aa))T[U].$=U,c.push(T[U]);0!==c.length&&(c.sort(Ka),e=c[0],1<e.q&&0.8<=Math.random()||(T.splice(e.$,1),setTimeout(function(){0>=b.health||(S(b),prompt.say("<i>"+e["1"].replace("<br>",'<br>"')+'"</i>',function(){3<La&&(Ja.timeout=setTimeout(function(){0<b.health&&(S(b),prompt.say('<i>"'+e["2"]+'"</i>',h,b.type))},2E3))},b.type),3>=++La&&prompt.say("Enemies will try to trick you. Click <b>SPACEBAR</b> to attack them, and continue to the room at the <b>FAR RIGHT</b>.",
function(){Ja.timeout=setTimeout(function(){0<b.health&&(S(b),prompt.say('<i>"'+e["2"]+'"</i>',h,b.type))},1E3)}))},100)))}}};
var prompt=new function(){this.callback=h;this.prompt_time=0;this.stack=[];this.status=l;this.say=function(a,b,c){this.stack.push({message:a,callback:b,"class":c||""})};this.display=function(){0<this.stack.length&&(this.prompt_time=(new Date).getTime(),this.status=g,H=this.stack.splice(0,1)[0],ca.innerHTML=H.message,ba.className=H["class"],this.callback=H.callback,ba.style.display="block")};this.clear=function(){(new Date).getTime()>this.prompt_time+500&&(-1===R.health&&location.reload(),this.status=
l,ba.style.display="none",Ca.set(-40,80,80),Da.set(0,10,0),this.callback instanceof Function&&(this.callback(),this.callback=h))}},u,V,W,H,G,I,z=new p,A=new p,y=new p,X=new p,Y=new V4,Z=new V4,$=new V4,Ma=new M4,Na=l,Oa=l,Pa=l,Qa=l,Ra=l,Sa=l,Ta=l,Ua,Va,Wa;
function Xa(){Va=(new Date).getTime();Wa=Va-Ua;Ua=Va;Na||(z.set(680,0.3,550),900<z.sub(R.d).w()&&(Na=g,prompt.say("Earlier today an airborne virus escaped from the lab, which has infected nearly 50% of the city's residents."),prompt.say("The INFECTED are not very strong, but are very smart. One by one they are capturing humans and killing them. This is their nest."),prompt.say("An ANTIDOTE is being held in a room to the FAR RIGHT. You must find it and release it before everyone becomes INFECTED.")));
if(!prompt.status){prompt.display();u=0;a:for(;u<s.length;u++)if(0<s[u].health){z.copy(s[u].e).sub(s[u].d);if(s[u]!==R&&s[u].u)for(V=0;V<s.length;V++)if(s[u]!==s[V],0<s[V].health&&s[u].infected!==s[V].infected&&0<s[u].o.length&&!s[u].v&&100>=A.copy(s[V].d).sub(s[u].d).w()){s[u].v=0.01;s[u].D=g;break}if(s[u].v){s[u].v+=0.1*(Wa/16);2<=s[u].v&&(s[u].v=0);if(s[u].D&&0.4<=s[u].v){s[u].D=l;var a=s[u],b=s[u]===R?100:"guard"===s[u].type?5:10;A.set(0,0,-1);Ma.H(a.j);Ma.A(A);A.r(10);A.add(a.d);for(V=0;V<s.length;V++)if(!(s[V].infected===
a.infected&&a!==R)&&!(0>=s[V].health)&&s[V]!==a&&200>=y.copy(s[V].d).sub(A).w()){s[V].health-=b;0>s[V].health&&(s[V].health=0);break}}s[u].h[1]=s[u].v;1<s[u].h[1]&&(s[u].h[1]=2-s[u].h[1]);0<s[u].o.length&&(s[u].o[0].h[1]=s[u].h[1])}if(0.3<Math.abs(z.x)||0.3<Math.abs(z.a))if(H=s[u]===R?0.025*Wa:0.019*Wa,A.copy(s[u].d),A.x+=Math.min(0.3<Math.abs(z.x)?H*(0<z.x?1:-1):0,Math.abs(s[u].e.x-s[u].d.x)),A.a+=Math.min(0.3<Math.abs(z.a)?H*(0<z.a?1:-1):0,Math.abs(s[u].e.a-s[u].d.a)),y.copy(s[u].d),y.x+=0.3<Math.abs(z.x)?
5*(0<z.x?1:-1):0,y.a+=0.3<Math.abs(z.a)?5*(0<z.a?1:-1):0,!(0>y.x||0>y.a||y.x/10>O[0].length-1||y.a/10>O.length-1||1!==O[Math.round(y.a/10)][Math.round(y.x/10)])){for(V=0;V<s.length;V++)if(!(0>=s[V].health)&&s[u]!==s[V]&&(X.copy(A).sub(s[V].d),20>=X.w()))continue a;s[u].d.x=A.x;s[u].d.a=A.a;s[u].j.F(A.n());s[u].t.J();s[u].N?(s[u].h[0]-=0.075,0>s[u].h[0]&&(s[u].N=l)):(s[u].h[0]+=0.075,1<s[u].h[0]&&(s[u].N=g));0<s[u].o.length&&(s[u].o[0].h[0]=1-s[u].h[0])}}else if(0===s[u].health&&(s[u].health=-1,s[u].h[0]=
0.5,s[u].h[1]=0,0<s[u].o.length&&(s[u].o[0].h[0]=0.5,s[u].o[0].h[1]=0),s[u].aa||Ia++,s[u].d.y+=0.5,A.copy(s[u].d),A.x+=0.02*Math.random()-0.01,A.y=10,A.a+=0.02*Math.random()-0.01,s[u].j.F(A),s[u].t.J(),"scientist"===s[u].type&&(R.health+=20,100<R.health&&(R.health=100)),s[u]===R))Ca.set(-15,30,15),prompt.say("You have been killed. Click or press any key to restart.")}z.copy(Ca).sub(Ba).r(0.015);1<z.w()&&z.r(1/z.length());Ba.add(z.r(Wa/16));z.copy(Da).sub(Aa).r(0.015);1<z.w()&&z.r(1/z.length());Aa.add(z.r(Wa/
16));z.copy(R.d).add(Ba);ya.M(z);z.copy(R.d).add(Aa);ya.F(z);render();if(80>=R.d.x&&60<=R.d.a&&130>=R.d.a)for(u=0;u<s.length;u++)if(!Sa&&"scientist"===s[u].type&&80>=s[u].d.x&&60<=s[u].d.a&&130>=s[u].d.a){Sa=g;s[u].u=g;A.copy(R.d);A.y=0.3;s[u].j.F(A);s[u].t.J();S(s[u]);render();prompt.say("<i>\"ID#43657 - Gregory! I'm so sorry about this. The app you downloaded, the mental assistant - there's something wrong with it. It's been giving you instructions, but you were coherent enough to question it. Thank god.\"</i>",
h,"scientist");prompt.say('<i>"We need you as a tool to convert the <b>INFECTEDS</b> - to show them which reality to believe. We need you on our side."</i>',function(){var a=0;setInterval(function(){a=a+0.01;J.style.opacity=1-a;if(a>1){a=1;R.health=-1}},10)},"scientist");prompt.say('<i>". . . You trust us, right?"</i>',h,"scientist");break}!Ta&&(1300<=R.d.x&&1320>=R.d.x&&90<=R.d.a&&110>=R.d.a)&&(Ta=g,prompt.say('Press "x" to rid the world of the virus.'));da(Xa)}var Ya=0;
FSorter=function(a,b){return b.f-a.f};expand=function(a,b){var c=b.x-a.x,e=b.y-a.y,f=c*c+e*e;0!=f&&(f=1/n(f),c*=f,e*=f,b.x+=c,b.y+=e,a.x-=c,a.y-=e)};createPerson=function(a,b){var c=new Model(Q.person,P[a]);c.type=a;c.h[0]=0;c.h[1]=0;c.p=Ga;c.P=l;c.D=l;c.health=100;c.infected="infected"===a;b&&(c.o.push(new Model(Q.poker,P.poker)),c.o[0].h[0]=c.o[0].h[1]=0,c.o[0].p=Ha);return c};
renderElements=function(){Fa.sort(FSorter);u=0;for(H=Fa.length;u<H;u++){G=Fa[u];G.b[0].x*=B/2;G.b[0].y*=E/2;G.b[0].x+=B/2;G.b[0].y+=E/2;G.b[1].x*=B/2;G.b[1].y*=E/2;G.b[1].x+=B/2;G.b[1].y+=E/2;G.b[2].x*=B/2;G.b[2].y*=E/2;G.b[2].x+=B/2;G.b[2].y+=E/2;var a=(new p(0.2,0.8,0.6)).normalize();light_value=Math.min(Math.max(a.B(G.G),0)+0.3,1);expand(G.b[0],G.b[1]);expand(G.b[1],G.b[2]);expand(G.b[2],G.b[0]);z.set(Math.round(G.j.x*light_value),Math.round(G.j.y*light_value),Math.round(G.j.a*light_value));G.da.u||
z.r(0.4);K.fillStyle="rgba("+Math.round(z.x)+","+Math.round(z.y)+","+Math.round(z.a)+","+G.j.f+")";K.beginPath();K.moveTo(G.b[0].x,E-G.b[0].y);K.lineTo(G.b[1].x,E-G.b[1].y);K.lineTo(G.b[2].x,E-G.b[2].y);K.lineTo(G.b[0].x,E-G.b[0].y);K.closePath();K.fill()}};
isVisible=function(a){var b=R.d;z.copy(a).sub(b);a=z.length();if(70<a)return l;z.normalize();A.copy(b);for(b=0;b<a-1;b++){if(O[Math.round(A.a/10)]!==d&&O[Math.round(A.a/10)][Math.round(A.x/10)]!==d&&0===O[Math.round(A.a/10)][Math.round(A.x/10)])return l;A.add(z)}return g};FR=new FR;projectionScreenMatrix=new M4;
prepareScene=function(){za.O(ya);projectionScreenMatrix.multiply(ga,za);FR.fa();Ea.length=0;var a,b;Ya+=1;5==Ya&&(Ya=0);for(u=0;u<N.length;u++)if(a=N[u],a.j.M(a.d),a.j.R(a.t),FR.contains(a)){0===Ya&&(a.u=isVisible(a.d));if(("scientist"===a.type||"civilian"===a.type)&&a.u&&!a.P&&100>=z.copy(a.d).sub(R.d).w())a.P=g,z.copy(a.d).sub(new p(680,0.3,340)),H=z.length()/10,G=8>=H?0:20>=H?1:35>=H?2:50>=H?3:4,Ja.speak(G,a);if(a.type&&a!==R&&a.u&&0.8<Math.random())if(0<a.o.length&&a.infected!==R.infected)a.e.copy(R.d);
else if(a.infected!==R.infected)0===Ya&&(a.e.copy(a.d).sub(R.d).normalize().r(5).add(a.d),a.e.x+=50*M(a.e.x/5,a.e.a/5),a.e.a+=50*M(a.e.x/5+50,a.e.a/5+50));else if(0<a.o.length){a.e.x=-1E3;for(V=0;V<s.length;V++)if(s[V]!==R&&0<s[V].health&&s[V].u&&s[V].infected!==a.infected&&2500>=z.copy(s[V].d).sub(a.d).w()){a.e.copy(s[V].d);break}-1E3===a.e.x&&(a.e.x+=50*M(a.d.x/5,a.d.a/5),a.e.a+=50*M(a.d.x/5+50,a.d.a/5+50))}else a.e.x+=50*M(a.d.x/5,a.d.a/5),a.e.a+=50*M(a.d.x/5+50,a.d.a/5+50);"guard"===a.type&&a.u&&
!Oa&&(Oa=g,S(a),prompt.say("The scientists here want to study the virus at any cost. As such, the lab's <b>GUARDS</b> will attempt to stop you. There's one now.<br><br> Press <b>SPACEBAR</b> when an enemy is in front of you to attack them."));"scientist"===a.type&&a.u&&!Pa&&(Pa=g,S(a),prompt.say("In the lab you will also encounter <b>SCIENTISTS</b>. They will attempt to escape if you chase them and will give you <b>HEALTH</b> if you kill them. There's one now. Try sneaking up on him and attacking."));
"civilian"===a.type&&a.u&&!Qa&&(Qa=g,S(a),prompt.say("The <b>INFECTED</b> are not physically dangerous, but are very crafty and will lead you into traps. Kill them on sight. There's a few now."));"infected"===a.type&&a.u&&!Ra&&(Ra=g,S(a),prompt.say("A few civilians have maintained their sanity, and are on your side. Do not hurt them, they will help you defeat <b>GUARDS</b> and the <b>INFECTED</b>."));Ea.push(a);for(V=0;V<a.o.length;V++)b=a.o[V],b.j.M(b.d),b.j.R(b.t),b.j.multiply(a.j,b.j),b.u=a.u,
Ea.push(b)}};grad=K.createRadialGradient(B/2,E/2,0,B/2,E/2,B/2);
render=function(){K.fillStyle="#000";K.fillRect(0,0,B,E);prepareScene();u=Fa.length=0;for(H=Ea.length;u<H;u++){G=Ea[u];Ma.H(G.j);var a;for(V=0;V<G.m.l.length;V++){z.copy(G.m.b[G.m.l[V].b[0]]);A.copy(G.m.b[G.m.l[V].b[1]]);y.copy(G.m.b[G.m.l[V].b[2]]);for(W=0;W<G.p.length;W++)X.set(G.p[W][3*G.m.l[V].b[0]],G.p[W][3*G.m.l[V].b[0]+1],G.p[W][3*G.m.l[V].b[0]+2]),z.add(X.r(G.h[W])),X.set(G.p[W][3*G.m.l[V].b[1]],G.p[W][3*G.m.l[V].b[1]+1],G.p[W][3*G.m.l[V].b[1]+2]),A.add(X.r(G.h[W])),X.set(G.p[W][3*G.m.l[V].b[2]],
G.p[W][3*G.m.l[V].b[2]+1],G.p[W][3*G.m.l[V].b[2]+2]),y.add(X.r(G.h[W]));G.j.A(z);G.j.A(A);G.j.A(y);Y.copy(z);Z.copy(A);$.copy(y);projectionScreenMatrix.L(Y);projectionScreenMatrix.L(Z);projectionScreenMatrix.L($);Y.x/=Y.f;Y.y/=Y.f;if(!(5>Y.a||250<Y.a))if(Z.x/=Z.f,Z.y/=Z.f,!(5>Y.a||250<Y.a))if($.x/=$.f,$.y/=$.f,!(5>Y.a||250<Y.a))if(a=0>($.x-Y.x)*(Z.y-Y.y)-($.y-Y.y)*(Z.x-Y.x))z.copy(G.m.l[V].G),Ma.A(z),I=(new F([Y.n(),Z.n(),$.n()],G.U[G.m.l[V].j],z.n())).W(),I.da=G,(G.u||!(0<G.p.length))&&Fa.push(I)}}renderElements();
K.fillStyle=grad;K.rect(0,0,B,E);K.fill();K.font="11pt Courier";0<R.health&&(a=B-0.9*B,K.fillStyle="#b30",K.fillRect(a,10,(B-2*a)*0.01*R.health,Math.min(20,0.1*E)),K.fillStyle="#fff",K.fillText("Health: "+R.health,B/2-50,25));0<Ia&&(K.fillStyle="#fff",K.fillText("Killed: "+Ia,B-100,25))};
title=function(){function a(a,e,j,q,i){var i=i||{},o;for(b=e;b<=q;b++)for(c=a;c<=j;c++)O[b][c]=1;var r={s:"scientist",c:"civilian",g:"guard",i:"infected"},m;for(m in r)if(0<i[m+"min"]&&i[m+"max"]){H=Math.floor(Math.random()*(i[m+"max"]-i[m+"min"]+1))+i[m+"min"];for(b=0;b<H;b++)o=l,"g"===m&&(o=g),"i"===m&&0.6<Math.random()&&(o=g),o=createPerson(r[m],o),o.d.set(10*(Math.random()*(j-a)+a),0.3,10*(Math.random()*(q-e)+e)),o.e.set(10*(Math.random()*(j-a)+a),0.3,10*(Math.random()*(q-e)+e)),s.push(o),N.push(o)}}
K.fillStyle="#241D23";K.fillRect(0,0,B,E);K.font="36pt Courier";K.fillStyle="#fff";K.fillText("Mindless",B/2-135,100);K.font="11pt Courier";K.fillText("Chandler Prall, Programmer",B-300,E-70);K.fillText("Nick Anderson,  Writer",B-300,E-50);K.fillText("Shawn Gardner,  Exec. Producer",B-300,E-30);var b,c;for(b=0;139>b;b++){O[b]=[];for(c=0;139>c;c++)O[b][c]=0}a(12,0,20,6,{imin:1,imax:1,smin:2,smax:2,cmin:1,cmax:1});a(16,7,20,7);a(22,0,31,6,{smin:3,smax:3,cmin:2,cmax:3});a(22,7,26,7);a(32,3,32,6);a(33,
0,42,6,{smin:4,smax:5});a(38,7,42,7);a(44,0,53,6,{gmin:1,gmax:1,cmin:4,cmax:4});a(46,7,48,7);a(55,0,64,9,{gmin:1,gmax:1,smin:4,smax:4});a(57,10,59,10);a(66,0,76,9,{gmin:1,gmax:1,smin:4,smax:4});a(72,10,74,10);a(78,0,81,10,{imin:1,imax:1,cmin:2,cmax:2,smin:2,smax:2});a(82,0,97,4,{smin:1,smax:2,cmin:1,cmax:2});a(83,5,97,9,{gmin:1,gmax:1,cmin:1,cmax:1});a(99,0,104,4,{gmin:1,gmax:1,smin:1,smax:2,cmin:2,cmax:2});a(106,0,115,4,{gmin:1,gmax:1,smin:3,smax:4});a(99,5,115,6);a(104,7,106,7);a(117,0,126,6,{gmin:1,
gmax:1,cmin:3,cmax:4});a(121,7,123,7);a(0,6,10,13,{smin:3,smax:6});a(11,9,11,10);a(12,8,17,14,{imin:7,imax:10});a(18,8,26,11);a(27,8,27,10);a(19,12,26,14);a(21,15,26,15);a(28,8,36,18,{cmin:3,cmax:4,smin:2,smax:2});a(37,10,37,12);a(32,19,34,19);a(38,8,53,13,{gmin:1,gmax:1,smin:1,smax:2,cmin:1,cmax:1});a(54,11,81,13,{imin:2,imax:2,smin:2,smax:3,cmin:1,cmax:1});a(57,14,59,14);a(78,14,81,14);a(98,8,126,12,{gmin:2,gmax:3,smin:2,smax:3,cmin:1,cmax:1});a(104,13,106,13);a(120,13,122,13);a(127,9,127,11);a(128,
6,138,14,{cmin:10,cmax:12});a(95,10,97,25);a(12,16,28,18,{gmin:1,gmax:1,imin:1,imax:1});a(12,19,21,19);a(38,15,42,40,{gmin:1,gmax:1,imin:1,imax:1,smin:3,smax:4});a(43,20,43,23);a(44,15,48,32,{gmin:1,gmax:1,imin:1,imax:1,cmin:2,cmax:3});a(49,15,49,19);a(50,15,54,32,{gmin:1,gmax:1,smin:2,smax:2,cmin:1,cmax:1});a(55,26,61,32,{cmin:2,cmax:2,smin:1,smax:1});a(62,27,65,32);a(56,15,67,25,{gmin:1,gmax:1,smin:3,smax:4});a(69,15,75,25,{imin:1,imax:2,smin:1,smax:1});a(76,17,76,19);a(72,26,75,26);a(77,15,81,
29,{imin:1,imax:2,smin:2,smax:3,gmin:1,gmax:1});a(82,17,82,19);a(78,30,80,30);a(83,11,86,29,{gmin:1,gmax:1,smin:2,smax:2,cmin:1,cmax:1});a(87,11,88,28,{gmin:1,gmax:1,smin:2,smax:2,cmin:1,cmax:1});a(89,22,93,28,{gmin:1,gmax:1,smin:1,smax:1,imin:1,imax:2});a(90,11,93,21);a(94,11,94,15);a(99,14,104,20,{gmin:1,gmax:1,smin:1,smax:2,cmin:1,cmax:2});a(105,14,105,15);a(106,14,115,20,{gmin:1,gmax:1,smin:3,smax:4,cmin:1,cmax:1});a(117,14,126,20,{gmin:1,gmax:1,cmin:3,cmax:5});a(12,20,36,24,{imin:2,imax:3,gmin:1,
gmax:1,cmin:1,cmax:1});a(37,20,37,23);a(98,22,100,25,{gmin:1,gmax:1,cmin:1,cmax:2});a(124,21,126,21);a(101,22,126,24,{gmin:1,gmax:1,cmin:2,cmax:3,smin:2,smax:4});a(43,38,51,40,{gmin:1,gmax:1,cmin:1,cmax:2});a(44,34,65,37,{cmin:4,cmax:5,smin:3,smax:4});a(70,27,75,29,{imin:2,imax:2});a(67,27,69,30,{cmin:2,cmax:2});a(67,31,69,35);a(67,36,69,36,{smin:1,smax:1});a(67,37,69,40);a(67,41,69,42,{gmin:1,gmax:1});a(67,43,69,56);a(71,31,81,37,{smin:2,smax:2,imin:3,imax:5});for(b=0;b<O[0].length;b++)for(c=0;c<
O.length;c++){switch(O[c][b]){case 1:H=new Model(Q.tile,P["floor_"+Math.floor(3*Math.random())]),H.d.set(10*b,0,10*c),N.push(H)}if(0!==O[c][b]){if(O[c-1]===d||0===O[c-1][b])H=new Model(Q.wall,P["wall_"+Math.floor(3*Math.random())]),H.d.set(10*b,0,10*c),N.push(H);if(O[c+1]===d||0===O[c+1][b])H=new Model(Q.wall,P["wall_"+Math.floor(3*Math.random())]),H.d.set(10*b,0,10*c),H.t.set(0,Math.PI,0),N.push(H);if(O[c][b-1]===d||0===O[c][b-1])H=new Model(Q.wall,P["wall_"+Math.floor(3*Math.random())]),H.d.set(10*
b,0,10*c),H.t.set(0,Math.PI/2,0),N.push(H);if(O[c][b+1]===d||0===O[c][b+1])H=new Model(Q.wall,P["wall_"+Math.floor(3*Math.random())]),H.d.set(10*b,0,10*c),H.t.set(0,Math.PI/-2,0),N.push(H)}}var e=new Model(Q.terminal,P.terminal);e.d.set(1310,0,100);O[10][131]=2;e.t.y=-Math.PI/2;N.push(e);R=createPerson("player",g);R.infected=g;R.d.set(680,0.3,550);R.e.copy(R.d);s.push(R);N.push(R);K.font="14pt Monospace";K.fillText("Click to start",B/2-100,200);document.addEventListener("click",function k(){document.removeEventListener("click",
k);grad.addColorStop(0,"rgba( 0, 0, 0, 0 )");grad.addColorStop(0.7,"rgba( 0, 0, 0, .3 )");grad.addColorStop(1,"rgba( 0, 0, 0, .8 )");document.addEventListener("keydown",function(a){if(prompt.status)prompt.clear();else switch(a.keyCode){case 32:R.v||(R.v=0.01,R.D=g);break;case 88:1280<=R.d.x&&(1380>=R.d.x&&60<=R.d.a&&140>=R.d.a)&&(prompt.say("C:> cd root<br>$[root] /RUN self_destruct.exe<br>-m'Humans Eliminated'<br><br>(Play Again)"),R.health=0,setTimeout(function(){Ca.set(80,150,80)},250),setInterval(function(){for(b=
0;10>b;b++)N.splice(Math.floor(Math.random()*(N.length-1)),1);if(0!==N.length)for(b=0;10>b;b++)N[Math.floor(Math.random()*(N.length-1))].t.x+=Math.random()*Math.PI-Math.PI/2,N[Math.floor(Math.random()*(N.length-1))].t.y+=Math.random()*Math.PI-Math.PI/2,N[Math.floor(Math.random()*(N.length-1))].t.a+=Math.random()*Math.PI-Math.PI/2},5))}});setTimeout(function(){Ca.set(-40,80,80)},1E3);document.addEventListener("click",function(a){if(prompt.status)prompt.clear();else{clearTimeout(Ja.timeout);var a=new p(2*
((a.clientX-J.offsetLeft)/B)-1,2*-((a.clientY-J.offsetTop)/E)+1,0.5),b=(new M4).O(ga);(new M4).multiply((new M4).H(ya),b).A(a);a.normalize();a.r(-ya.I().y/a.y);a.add(ya.I().n());R.e.set(a.x,0.3,a.a)}});prompt.say("Welcome to <b>Biochemical Lab #13</b>. Left click on the map to walk.");Ua=(new Date).getTime();Xa()})};J.width=B;J.height=E;title();
</script></body></html>